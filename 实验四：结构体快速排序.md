```java
#define _CRT_SECURE_NO_DEPRECATE
#include<stdio.h>
#include<Windows.h>
typedef struct link_node {
	char IDnumber[20];
	char name[20];
	char department[20];
	int stuclass;
	struct link_node *next;
}node;

node getMedia(node *no, int low, int high) {
	node *p;
	p = no;
	node med;
	med = no[low];//标记
	int i = low;
	int j = high;
	while (i != j) {
		while (no[j].IDnumber >= med.IDnumber&&i < j) {
			j--;
		}
		while (no[i].IDnumber <= med.IDnumber&&i < j) {
			i++;
		}
		node temp = no[i];
		no[j] = no[i];
		no[i] = temp;
	}
	node temp = no[low];
	no[low] = no[i];
	no[i] = temp;
	return no[i];
}

int getNext(node *no, node me, int high) {
	int i = 0;
	for (int i = 0; i < high; i++) {
		if (strcmp(no[i].IDnumber, me.IDnumber) != 0) {
			i++;
		}
		else {
			if (i + 1 > high) {
				return 0;
			}
			return i + 1;
		}
	}
	return 0;
}

int getLast(node *no, node me, int high) {
	int i = 0;
	for (int i = 0; i < high; i++) {
		if (strcmp(no[i].IDnumber, me.IDnumber) != 0) {
			i++;
		}
		else {
			if (i - 1 >= 0) {
				return i - 1;
			}
			else {
				return 0;
			}
		}
	}
	return 0;
}

node* sort(node *no, int low, int high) {//low high 均为下标
	if (low < high) {
		node md = getMedia(no, low, high);
		int i = getLast(no, md, high);
		int j = getNext(no, md, i);
		sort(no, 0, i);
		sort(no, j, high);

	}
	return no;
}

node create(node no, int n) {
	printf("please input %dth message\n", n + 1);
	scanf("%s%s%s%d", &no.IDnumber, &no.name, &no.department, &no.stuclass);
	return no;
}

void display(node no, int n) {
	printf("%s %s %s %d", no.IDnumber, no.name, no.department, no.stuclass);
	printf("\n");

}
int main() {
	int high, low = 0;
	printf("please input the messages number:\n");
	scanf("%d", &high);
	node *no = (node*)malloc(high * sizeof(node));//构造器
	for (int i = 0; i < high; i++) {
		no[i] = create(no[i], i);
		//scanf("%s%s%s%d", &no[i].IDnumber, &no[i].name, &no[i].department, &no[i].stuclass);
	}
	printf("the %dth message is\n");
	for (int i = 0; i < high; i++) {
		display(no[i], i);
	}
	printf("sort\n");
	no = sort(no, low, high - 1);//low指向第一个元素，下标为0。high指向最后一个元素，下标为high-1。
	system("pause");
	return 0;
}
```
